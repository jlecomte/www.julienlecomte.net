<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>Getting Rid of the Click Noise When Using IFrames on Internet Explorer</title>
  </head>
  <body>

    <p><button id="mybtn1">Click</button> to change the <code>src</code> attribute of the IFrame below:</p>
    <iframe id="myiframe1"></iframe>
    <p><button id="mybtn2">Click</button> to change the <code>src</code> attribute of the IFrame below without getting the annoying click noise on Internet Explorer:</p>
    <iframe id="myiframe2"></iframe>

    <script src="http://yui.yahooapis.com/2.3.1/build/yahoo-dom-event/yahoo-dom-event.js"></script>
    <script>

(function () {

    var idx1, idx2, targets;

    idx1 = 0;
    idx2 = 0;

    targets = [
        "http://static.flickr.com/74/162582364_7fc3e2d60d_s.jpg",
        "http://static.flickr.com/67/162582262_e969394bc3_s.jpg",
        "http://static.flickr.com/49/162582189_e0571b02e2_s.jpg",
        "http://static.flickr.com/53/162581581_de49021696_s.jpg",
        "http://static.flickr.com/74/161894590_9a1a9788e1_s.jpg",
        "http://static.flickr.com/55/161894230_a4f1baf3d2_s.jpg",
        "http://static.flickr.com/52/161894040_04f135f1a2_s.jpg",
        "http://static.flickr.com/54/161893927_c173a1e28c_s.jpg",
        "http://static.flickr.com/72/161893872_6800ebea26_s.jpg",
        "http://static.flickr.com/77/161892664_755fdad7b6_s.jpg",
        "http://static.flickr.com/64/161892344_25ed032a4b_s.jpg",
        "http://static.flickr.com/51/154250687_c241e9b5a2_s.jpg",
        "http://static.flickr.com/58/154252383_d59833136c_s.jpg",
        "http://static.flickr.com/72/154249854_e478567f11_s.jpg",
        "http://static.flickr.com/52/154249682_0e000a8bbd_s.jpg",
        "http://static.flickr.com/49/154250868_9ed96d9fdf_s.jpg",
        "http://static.flickr.com/52/154250543_633506d4cf_s.jpg",
        "http://static.flickr.com/46/161892486_b4f8b93917_s.jpg",
        "http://static.flickr.com/72/162582313_e0289e18cb_s.jpg"
    ];

    function setIFrameSrc(iframe, src) {
        var el;
        iframe = YAHOO.util.Dom.get(iframe);
        if (YAHOO.env.ua.ie) {
            // Create a new hidden iframe.
            el = iframe.cloneNode(true);
            el.style.position = "absolute";
            el.style.visibility = "hidden";
            // keep the original iframe id unique!
            el.id = "";
            // Listen for the onload event.
            YAHOO.util.Event.addListener(el, "load", function () {
                // First, remove the event listener or the old iframe
                // we intend to discard will not be freed...
                YAHOO.util.Event.removeListener(this, "load", arguments.callee);
                // Show the iframe.
                this.style.position = "";
                this.style.visibility = "";
                // Replace the old iframe with the new one.
                iframe.parentNode.replaceChild(this, iframe);
                // Reset the iframe id.
                this.id = iframe.id;
            });
            // Set its src first...
            el.src = src;
            // ...and then append it to the body of the document.
            document.body.appendChild(el);
        } else {
            iframe.src = src;
        }
    }

    YAHOO.util.Event.addListener("mybtn1", "click", function () {
        YAHOO.util.Dom.get("myiframe1").src = targets[idx1];
        idx1 = (idx1 + 1) % targets.length;
    });

    YAHOO.util.Event.addListener("mybtn2", "click", function () {
        setIFrameSrc("myiframe2", targets[idx2]);
        idx2 = (idx2 + 1) % targets.length;
    });

})();

    </script>
  </body>
</html>
