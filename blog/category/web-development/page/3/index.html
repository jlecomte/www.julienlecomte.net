<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<title>Web Development | Julien Lecomte&#039;s Blog | Page 3</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="http://www.julienlecomte.net/blog/xmlrpc.php" />
<!--[if lt IE 9]>
<script src="http://www.julienlecomte.net/blog/wp-content/themes/twentytwelve/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="Julien Lecomte&#039;s Blog &raquo; Feed" href="../../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Julien Lecomte&#039;s Blog &raquo; Comments Feed" href="../../../../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Julien Lecomte&#039;s Blog &raquo; Web Development Category Feed" href="../../feed/index.html" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"http:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/www.julienlecomte.net\/blog\/wp-includes\/js\/wp-emoji-release.min.js"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='colorbox-theme1-css'  href='../../../../wp-content/plugins/jquery-lightbox-for-native-galleries/colorbox/theme1/colorbox.css' type='text/css' media='screen' />
<link rel='stylesheet' id='twentytwelve-fonts-css'  href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&#038;subset=latin,latin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='twentytwelve-style-css'  href='../../../../wp-content/themes/twentytwelve/style.css' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='http://www.julienlecomte.net/blog/wp-content/themes/twentytwelve/css/ie.css' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery.js'></script>
<script type='text/javascript' src='../../../../wp-includes/js/jquery/jquery-migrate.min.js'></script>
<script type='text/javascript' src='../../../../wp-content/plugins/jquery-lightbox-for-native-galleries/colorbox/jquery.colorbox-min.js'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../../xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.3" />
	<link href="../../../../wp-content/plugins/google-code-prettify/prettify.css" type="text/css" rel="stylesheet" />
    <script type="text/javascript" src="../../../../wp-content/plugins/google-code-prettify/prettify.js"></script>
	<!-- jQuery Lightbox For Native Galleries v3.2.2 | http://www.viper007bond.com/wordpress-plugins/jquery-lightbox-for-native-galleries/ -->
<script type="text/javascript">
// <![CDATA[
	jQuery(document).ready(function($){
		$(".gallery").each(function(index, obj){
			var galleryid = Math.floor(Math.random()*10000);
			$(obj).find("a").colorbox({rel:galleryid, maxWidth:"95%", maxHeight:"95%"});
		});
		$("a.lightbox").colorbox({maxWidth:"95%", maxHeight:"95%"});
	});
// ]]>
</script>
</head>

<body class="archive paged category category-web-development category-3 paged-3 category-paged-3 full-width custom-font-enabled single-author">
<div id="page" class="hfeed site">
	<header id="masthead" class="site-header" role="banner">
		<hgroup>
			<h1 class="site-title"><a href="../../../../../index.html" title="Julien Lecomte&#039;s Blog" rel="home">Julien Lecomte&#039;s Blog</a></h1>
			<h2 class="site-description">Woodworking, Amateur Astronomy, Web Development and Operating System Programming.</h2>
		</hgroup>

		<nav id="site-navigation" class="main-navigation" role="navigation">
			<button class="menu-toggle">Menu</button>
			<a class="assistive-text" href="index.html#content" title="Skip to content">Skip to content</a>
			<div class="nav-menu"><ul><li ><a href="../../../../../index.html">Home</a></li><li class="page_item page-item-36"><a href="../../../../about-the-author/index.html">About The Author</a></li></ul></div>
		</nav><!-- #site-navigation -->

			</header><!-- #masthead -->

	<div id="main" class="wrapper">
	<section id="primary" class="site-content">
		<div id="content" role="main">

					<header class="archive-header">
				<h1 class="archive-title">Category Archives: <span>Web Development</span></h1>

						</header><!-- .archive-header -->

			
	<article id="post-16" class="post-16 post type-post status-publish format-standard hentry category-web-development">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="../../../../2007/09/16/index.html" rel="bookmark">Building Web Applications With Apache Ant</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<h4>The importance of having a solid build process</h4>
<p>Modern web applications are large and complicated pieces of engineering, using many different technologies, sometimes deployed on hundreds (or even thousands) of servers throughout the world, and used by people from dozens of locales. Such applications cannot efficiently be developed without relying on a solid build process to do all the dirty and repetitive work of reliably putting all the pieces together.</p>
<h4>Apache Ant</h4>
<p><img src="../../../../../blogfiles/images/apache-ant-logo.png" style="width:120px;height:35px;border:none;float:right;margin-left:10px;" alt="Apache Ant"></p>
<p>Many tools (make, gnumake, nmake, jam, etc.) are available today to build applications. However, when it comes to building a <em>web</em> application, my personal favorite is definitely <a href="http://ant.apache.org/" target="_blank">Apache Ant</a> (here is a <a href="http://ant.apache.org/manual/intro.html" target="_blank">good explanation</a> of Ant&#8217;s benefits over the other tools) This short tutorial will assume you already have some basic knowledge of Ant (if you don&#8217;t, you should flip through its <a href="http://ant.apache.org/manual/index.html" target="_blank">user manual</a> beforehand) This article will focus mainly on building front-end code using Ant.</p>
<p><br style="clear:both;line-height:0;"/></p>
<h4>Build types</h4>
<p>It is often useful to build an application differently at different stages of its life cycle. For instance, a development build will have assertions and tons of logging code, while a production version will be stripped of all that. You may also need some intermediate build to hand off to QA, and still be able to debug things easily while running actual production code. With Ant, you can create one target per build type, and have a different dependency list for each target. Properties can also be used to customize specific build types. Here is an example:</p>
<pre class="prettyprint" style="overflow:auto;overflow-y:hidden;">
&#60;target name="dev" depends="load.properties.dev, js.preprocess, js.check.syntax, copy.jsp, copy.image.files, copy.css.files, copy.js.files, compile.jsp, copy.properties.files, compile.webapps, copy.libs"
    description="Development build"&#62;
&#60;/target&#62;

&#60;target name="prod" depends="load.properties.prod, js.preprocess, js.check.syntax, js.concatenate, js.minify, copy.jsp, copy.image.files, copy.css.files, copy.js.files, compile.jsp, copy.properties.files, compile.webapps, copy.libs"
    description="Full production build"&#62;
&#60;/target&#62;

&#60;target name="load.properties"&#62;
    &#60;property file="ant.properties"/&#62;
&#60;/target&#62;

&#60;target name="load.properties.dev" depends="load.properties"&#62;
    &#60;property name="js.preprocess.switches" value="-P -DDEBUG_VERSION=1"/&#62;
    &#60;property name="js.compressor.switches" value="--nomunge --line-break"/&#62;
&#60;/target&#62;

&#60;target name="load.properties.prod" depends="load.properties"&#62;
    &#60;property name="js.preprocess.switches" value="-P -DDEBUG_VERSION=0"/&#62;
    &#60;property name="js.compressor.switches" value=""/&#62;
&#60;/target&#62;
</pre>
<h4>Concatenate your JavaScript and CSS files</h4>
<p>Concatenating JavaScript and CSS files contributes to making your site faster <a href="http://developer.yahoo.com/performance/rules.html#num_http" target="_blank">according to Yahoo!&#8217;s Exceptional Performance team</a>. File concatenation using Ant is trivial using the <code>concat</code> task. However, it is often important to concatenate JavaScript and CSS files in a very specific order (If you are using <a href="http://developer.yahoo.com/yui/" target="_blank">YUI</a> for example, you want yahoo.js to appear first, and then dom.js/event.js, and then animation.js, etc. in order to respect module dependencies) This can be accomplished using a filelist, or a combination of filesets. Here is an example:</p>
<pre class="prettyprint">
&#60;target name="js.concatenate"&#62;
    &#60;concat destfile="${build.dir}/concatenated/foo.js"&#62;
        &#60;filelist dir="${src.dir}/js"
            files="a.js, b.js"/&#62;
        &#60;fileset dir="${src.dir}/js"
            includes="*.js"
            excludes="a.js, b.js"/&#62;
    &#60;/concat&#62;
&#60;/target&#62;
</pre>
<p>It is also possible to prepend some comments to the destination file, which is often used for license and copyright information, using a nested <code>header</code> element (see the <a href="http://ant.apache.org/manual/CoreTasks/concat.html" target="_blank">Apache Ant manual</a>) Just keep in mind that minifying your code will make these comments go away, so you may want to do this later in the build process.</p>
<h4>Preprocess your JavaScript files using CPP</h4>
<p>Preprocessing JavaScript code is very useful to facilitate the development process. It allows you to define your own macros, and conditionally compile blocks of code. One easy way to preprocess JavaScript code is to use the <a href="http://en.wikipedia.org/wiki/C_preprocessor" target="_blank">C preprocessor</a>, which is usually installed by default on UNIX machines. It is available on Windows machines as well using <a href="http://www.cygwin.com/" target="_blank">cygwin</a>. Here is a snippet of an Ant build.xml file illustrating the use of cpp to preprocess JavaScript files:</p>
<pre class="prettyprint">
&#60;target name="js.preprocess" depends="js.concatenate"&#62;
    &#60;apply executable="cpp" dest="${build.dir}/preprocessed"&#62;
        &#60;fileset dir="${build.dir}/concatenated"
            includes="foo.js"/&#62;
        &#60;arg line="${js.preprocess.switches}"/&#62;
        &#60;srcfile/&#62;
        &#60;targetfile/&#62;
        &#60;mapper type="identity"/&#62;
    &#60;/apply&#62;
&#60;/target&#62;
</pre>
<p>You can now write JavaScript code that looks like the following:</p>
<p><em>include.js</em>:</p>
<pre class="prettyprint">
#if DEBUG_VERSION
function assert(condition, message) {
    ...
}
#define ASSERT(x, ...) assert(x, ## __VA_ARGS__)
#else
#define ASSERT(x, ...)
#endif
</pre>
<p><em>foobar.js</em>:</p>
<pre class="prettyprint">
#include "include.js"

function myFunction(arg) {
    ASSERT(YAHOO.lang.isString(argvar), "arg should be a string");
    ...
#if DEBUG_VERSION
    YAHOO.log("Log this in debug mode only");
#endif
    ...
}
</pre>
<p>Just a word of caution here: make sure you use the UNIX EOL character before preprocessing your files. Otherwise, you&#8217;ll have some issues with multi-line macros. You may use the <code>fixcrlf</code> Ant task to automatically fix that for you.</p>
<h4>Minify your JavaScript and CSS files</h4>
<p>Minifying your JavaScript and CSS files will help make your application faster <a href="http://developer.yahoo.com/performance/rules.html#minify" target="_blank">according to Yahoo!&#8217;s Exceptional Performance team</a>. I warmly recommend you use the YUI Compressor, available for <a href="http://www.julienlecomte.net/yuicompressor/" target="_blank">download</a> on this site. There are two ways to call the YUI Compressor from Ant. Here is the first one using the <code>java</code> task:</p>
<pre class="prettyprint">
&#60;target name="js.minify" depends="js.preprocess"&#62;
    &#60;java jar="yuicompressor.jar" fork="true"&#62;
        &#60;arg value="foo.js"/&#62;
    &#60;/java&#62;
&#60;/target&#62;
</pre>
<p>Here is another way using the <code>apply</code> task that allows you to pass several files to the compressor using a <code>fileset</code>:</p>
<pre class="prettyprint">
&#60;target name="js.minify" depends="js.preprocess"&#62;
    &#60;apply executable="java" parallel="false"&#62;
        &#60;fileset dir="." includes="foo.js, bar.js"/&#62;
        &#60;arg line="-jar"/&#62;
        &#60;arg path="yuicompressor.jar"/&#62;
        &#60;mapper type="glob" from="*.js" to="*-min.js"/&#62;
    &#60;/apply&#62;
&#60;/target&#62;
</pre>
<p><strong>Update:</strong> Starting with version 2.2.x of the YUI Compressor, the ant target described above needs to be slightly modified:</p>
<pre class="prettyprint">
&#60;target name="js.minify" depends="js.preprocess"&#62;
    &#60;apply executable="java" parallel="false"&#62;
        &#60;fileset dir="." includes="foo.js, bar.js"/&#62;
        &#60;arg line="-jar"/&#62;
        &#60;arg path="yuicompressor.jar"/&#62;
        &#60;srcfile/&#62;
        &#60;arg line="-o"/&#62;
        &#60;mapper type="glob" from="*.js" to="*-min.js"/&#62;
        &#60;targetfile/&#62;
    &#60;/apply&#62;
&#60;/target&#62;
</pre>
<p>Also consider the following ant target to minify CSS files:</p>
<pre class="prettyprint">
&#60;target name="js.minify" depends="js.preprocess"&#62;
    &#60;apply executable="java" parallel="false"&#62;
        &#60;fileset dir="." includes="*.css"/&#62;
        &#60;arg line="-jar"/&#62;
        &#60;arg path="yuicompressor.jar"/&#62;
        &#60;arg line="--line-break 0"/&#62;
        &#60;srcfile/&#62;
        &#60;arg line="-o"/&#62;
        &#60;mapper type="glob" from="*.css" to="*-min.css"/&#62;
        &#60;targetfile/&#62;
    &#60;/apply&#62;
&#60;/target&#62;
</pre>
<h4>Work around caching issues</h4>
<p><a href="http://developer.yahoo.com/performance/rules.html#expires" target="_blank">Adequate cache control</a> can really enhance your users&#8217; experience by not having them re-download static content (usually JavaScript, CSS, HTML and images) when coming back to your site. This has a downside however: when rev&#8217;ing your application, you want to make sure your users get the latest static content. The only way to do that is to change the name of these files (for example by adding a time stamp to their file name, or using their checksum as their file name) You must also propagate that change to all the files that refer to them.</p>
<p>The copy and file name replacement will be handled by a custom Ant task named FileTransform (see <a href="../../../../../blogfiles/apache-ant/FileTransform.java" target="_blank">FileTransform.java</a>) The first step is to build the task from the source and define the custom task:</p>
<pre class="prettyprint">
&#60;target name="-setup.build.tools" depends="-load.properties"&#62;
    &#60;mkdir dir="${build.dir}/tools/classes"/&#62;
    &#60;javac srcdir="tools/src"
           destdir="${build.dir}/tools/classes"
           includes="**/*.java"&#62;
        &#60;classpath&#62;
            &#60;pathelement location="tools/lib/ant.jar"/&#62;
        &#60;/classpath&#62;
    &#60;/javac&#62;
    &#60;taskdef name="FileTransform"
        classname="com.yahoo.platform.build.ant.FileTransform"
        classpath="${build.dir}/tools/classes"/&#62;
&#60;/target&#62;
</pre>
<p>(Note the use of a &#8220;-&#8221; in front of the name of the target. This is used to make the target &#8220;private&#8221; i.e. not invokable directly) The second part is the copy of the static content that is going to be cached using the newly defined FileTransform task:</p>
<pre class="prettyprint">
&#60;target name="-copy.js.files" depends="-setup.build.tools"&#62;
    &#60;mkdir dir="${build.dir}/js"/&#62;
    &#60;FileTransform todir="${build.dir}/js"
        changefilenames="true"
        propertiesfile="${build.dir}/js.files.mapping.properties"&#62;
        &#60;fileset dir="site/js" includes="*.js"/&#62;
    &#60;/FileTransform&#62;
&#60;/target&#62;
</pre>
<p>The mapping between the old names and the new names is stored in a properties file. The final step is the copy of the files that refer to files which name was changed in the previous step. For this, we use the <code>copy</code> task:</p>
<pre class="prettyprint">
&#60;target name="-copy.php.files" depends="-copy.js.files"&#62;
    &#60;mkdir dir="${build.dir}/php"/&#62;
    &#60;copy todir="${build.dir}/php"&#62;
        &#60;fileset dir="site/php" includes="*.php"/&#62;
        &#60;filterset&#62;
            &#60;filtersfile file="${build.dir}/js.files.mapping.properties"/&#62;
        &#60;/filterset&#62;
    &#60;/copy&#62;
&#60;/target&#62;
</pre>
<p>You can <a href="../../../../../blogfiles/apache-ant/ant-filetransform-project.zip">download</a> an archive containing a very simple Ant project illustrating this advanced technique.</p>
<h4>Deploy your application</h4>
<p>Deploying a web application is usually done by copying a set of files over to the production servers and running a list of commands on those servers (stop the services, run a few shell commands, and finally restart the services)</p>
<p>You have many options to copy files to remote servers with Apache Ant. You could use the <code>copy</code> task to copy files to a locally mounted file system, or you could use the optional <code>FTP</code> task. My personal preference is to use <code>scp</code> and <code>rsync</code> (both utilities are available on all major platforms) Here is a very simple example demonstrating the use of <code>scp</code> with Apache Ant:</p>
<pre class="prettyprint">
&#60;apply executable="scp" failonerror="true" parallel="true"&#62;
    &#60;fileset dir="${build.dir}" includes="**/*"/&#62;
    &#60;srcfile/&#62;
    &#60;arg line="${live.server}:/var/www/html/"/&#62;
&#60;/apply&#62;
</pre>
<p>And here is an example showing how you can run remote commands:</p>
<pre class="prettyprint">
&#60;exec executable="ssh" failonerror="true"&#62;
    &#60;arg line="${live.server}"/&#62;
    &#60;arg line="sudo webctl restart"/&#62;
&#60;/exec&#62;
</pre>
<h4>Conclusion</h4>
<p>I hope this article has given you some ideas of what&#8217;s possible to automate with modern build tools such as Apache Ant (other cool things include automatic generation of documentation, source control integration, packaging using rpm and such, etc.) My professional experience has taught me that the build process cannot be an afterthought. Just like performance, it should be part of your project from the very beginning. The second lesson is that all web developers need to be active participants in creating and maintaining the build process (with maybe one build engineer to centralize all the information) instead of relying on somebody else to build their component. Finally, keep your build process alive and maintain it actively as your needs will change during your project life cycle.</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="../../index.html" rel="category tag">Web Development</a> on <a href="../../../../2007/09/16/index.html" title="1:37 pm" rel="bookmark"><time class="entry-date" datetime="2007-09-11T13:37:31+00:00">September 11, 2007</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../../../author/admin/index.html" title="View all posts by Julien Lecomte" rel="author">Julien Lecomte</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

	<article id="post-19" class="post-19 post type-post status-publish format-standard hentry category-web-development">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="../../../../2007/09/19/index.html" rel="bookmark">The Rich Web Experience 2007</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<p>I am currently attending the <a href="http://www.therichwebexperience.com/" target="_blank">Rich Web Experience</a> conference in San Jose. Lots of great topics are being covered by immensely talented speakers who are passionate about sharing their knowledge. Here are a few pictures I took with my iPhone (hover over the images to get a short description)</p>
<p><a href="../../../../../blogfiles/rich-web-experience-2007/photos/photo1.jpg" style="float:left;margin-right:10px;" target="_blank"><img src="../../../../../blogfiles/rich-web-experience-2007/thumbs/photo1.jpg" width="120" height="90" alt="A panel of experts talking about the current state of affairs in rich Internet application development" title="A panel of experts talking about the current state of affairs in rich Internet application development"></a></p>
<p><a href="../../../../../blogfiles/rich-web-experience-2007/photos/photo2.jpg" style="float:left;margin-right:10px;" target="_blank"><img src="../../../../../blogfiles/rich-web-experience-2007/thumbs/photo2.jpg" width="120" height="90" alt="Dean Saxe talking about secure application development with Ajax" title="Dean Saxe talking about secure application development with Ajax"></a></p>
<p><a href="../../../../../blogfiles/rich-web-experience-2007/photos/photo3.jpg" style="float:left;" target="_blank"><img src="../../../../../blogfiles/rich-web-experience-2007/thumbs/photo3.jpg" width="120" height="90" alt="Yahoos having lunch" title="Yahoos having lunch"></a></p>
<p><br style="clear:both;line-height:0;"/></p>
<p><a href="../../../../../blogfiles/rich-web-experience-2007/photos/photo4.jpg" style="float:left;margin-right:10px;" target="_blank"><img src="../../../../../blogfiles/rich-web-experience-2007/thumbs/photo4.jpg" width="120" height="90" alt="Kevin Hoyt from Adobe having some problems with his Mac" title="Kevin Hoyt from Adobe having some problems with his Mac"></a></p>
<p><a href="../../../../../blogfiles/rich-web-experience-2007/photos/photo5.jpg" style="float:left;margin-right:10px;" target="_blank"><img src="../../../../../blogfiles/rich-web-experience-2007/thumbs/photo5.jpg" width="120" height="90" alt="Mark Meeker talking about accessibility" title="Mark Meeker talking about accessibility"></a></p>
<p><a href="../../../../../blogfiles/rich-web-experience-2007/photos/photo6.jpg" style="float:left;" target="_blank"><img src="../../../../../blogfiles/rich-web-experience-2007/thumbs/photo6.jpg" width="120" height="90" alt="The master at work: Douglas Crockford talking about JavaScript" title="The master at work: Douglas Crockford talking about JavaScript"></a></p>
<p><br style="clear:both;line-height:0;"/></p>
<p><strong>Update:</strong> Douglas Crockford&#8217;s keynote was absolutely brilliant as usual (I&#8217;m not just saying that because I happen to be sitting only a few feet away from him at Yahoo!) and I hope it will have made a lot of people think about some of the problems our industry is facing.</p>
<p><strong>Update:</strong> I was very disappointed with Jesse James Garrett&#8217;s keynote on Friday. The beginning of his talk  was irritating to say the least as it was focused mainly on his personality (Extract: &#8220;You may be wondering why I&#8217;m so famous&#8221;&#8230;) He then talked about the history of Ajax. According to him, Ajax started when he discovered it (2004?), but he completely forgot to mention that a lot of people were already doing Ajax back in the 90&#8217;s (OddPost, back in 2001, was already doing what would still be considered cutting edge Ajax by today&#8217;s standards) Finally, the rest of his talk was directed towards user experience designers, not engineers. I know UED had a strong presence at the conference, so I won&#8217;t blame him for that. I just found it extremely boring. Sorry Jesse!</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="../../index.html" rel="category tag">Web Development</a> on <a href="../../../../2007/09/19/index.html" title="5:12 pm" rel="bookmark"><time class="entry-date" datetime="2007-09-06T17:12:33+00:00">September 6, 2007</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../../../author/admin/index.html" title="View all posts by Julien Lecomte" rel="author">Julien Lecomte</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

	<article id="post-15" class="post-15 post type-post status-publish format-standard hentry category-web-development">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="../../../../2007/08/15/index.html" rel="bookmark">YUI Compressor Version 2.1 Now Available</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<p>This new version of the compressor fixes a few bugs and optimizes string concatenations. You can now keep your code nicely formatted by concatenating string literals, but not suffer any performance hit. For example, the following code:</p>
<pre class="prettyprint">
var url = "http://www.flickr.com/services/rest/"
    + "?method=flickr.test.echo"
    + "&#038;format=json"
    + "&#038;api_key=02b6a73df2c4a33c282f3d02fe5724e3"
    + "&#038;callback=jsonCallback";
</pre>
<p>will become (<span class="cr">&crarr;</span> marks a line continuation)</p>
<pre class="prettyprint">
var url = "http://www.flickr.com/services/rest/<span class="cr">&crarr;</span>
?method=flickr.test.echo&#038;format=json<span class="cr">&crarr;</span>
&#038;api_key=02b6a73df2c4a33c282f3d02fe5724e3&#038;callback=jsonCallback";
</pre>
<p>Also, note that, from now on, all YUI Compressor-related downloads will be done from a separate download page and not directly from this blog.</p>
<p style="margin:30px 0;text-align:center;"><a href="http://www.julienlecomte.net/yuicompressor/" target="_blank" style="padding:8px;border:1px solid #bbb;font-weight:bold;text-decoration:underline;">Download version 2.1 of the YUI Compressor</a></p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="../../index.html" rel="category tag">Web Development</a> on <a href="../../../../2007/08/15/index.html" title="12:34 pm" rel="bookmark"><time class="entry-date" datetime="2007-08-29T12:34:51+00:00">August 29, 2007</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../../../author/admin/index.html" title="View all posts by Julien Lecomte" rel="author">Julien Lecomte</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

	<article id="post-14" class="post-14 post type-post status-publish format-standard hentry category-web-development">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="../../../../2007/08/14/index.html" rel="bookmark">YUI Compressor Version 2.0 Now Available</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<p>I am very pleased to announce the release of version 2.0 of the YUI Compressor. In addition to fixing several bugs and implementing a few enhancements suggested by the community, I also integrated <a href="http://foohack.com/" target="_blank">Isaac Schlueter</a>&#8216;s regular expression based CSS minifier. Therefore, the YUI Compressor is now able to compress both JavaScript and CSS files (see the <a href="http://www.julienlecomte.net/blogfiles/yuicompressor/CHANGELOG" target="_blank">CHANGELOG</a> for a full list of changes) And as always, keep the feedback coming!</p>
<p style="margin:30px 0;text-align:center;"><a href="http://www.julienlecomte.net/yuicompressor/" target="_blank" style="padding:8px;border:1px solid #bbb;font-weight:bold;text-decoration:underline;">Download version 2.0 of the YUI Compressor</a></p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="../../index.html" rel="category tag">Web Development</a> on <a href="../../../../2007/08/14/index.html" title="11:09 am" rel="bookmark"><time class="entry-date" datetime="2007-08-27T11:09:35+00:00">August 27, 2007</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../../../author/admin/index.html" title="View all posts by Julien Lecomte" rel="author">Julien Lecomte</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

	<article id="post-13" class="post-13 post type-post status-publish format-standard hentry category-web-development">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="../../../../2007/08/13/index.html" rel="bookmark">Gzip Your Minified JavaScript Files</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<p>Today, I found out that the good folks behind <a href="http://jquery.com/" target="_blank">jQuery</a> were using <a href="http://dean.edwards.name/packer/" target="_blank">Packer</a>, another great JavaScript compression utility by Dean Edwards, to distribute their compressed version of the library. The result: an amazingly small 21KB download! My first thought was: Wow, that is small! I then tried the <a href="../../../../2007/08/13/introducing-the-yui-compressor/index.html" target="_blank">YUI Compressor</a> on the uncompressed version of the jQuery library and obtained a 31KB file. Not bad, but not nearly as good as Packer&#8230; I then decided to compare the gzipped version of these files. Here are my findings:</p>
<table border="1">
<thead>
<tr>
<th>File</th>
<th>File size</th>
<th>Gzipped file size</th>
</tr>
</thead>
<tbody>
<tr>
<td>Original jQuery library</td>
<td>62,885 bytes</td>
<td>19,758 bytes</td>
</tr>
<tr>
<td>jQuery minified with JSMin</td>
<td>36,391 bytes</td>
<td>11,541 bytes</td>
</tr>
<tr>
<td>jQuery minified with Packer</td>
<td>21,557 bytes</td>
<td>11,119 bytes</td>
</tr>
<tr>
<td>jQuery minified with the YUI Compressor</td>
<td>31,822 bytes</td>
<td>10,818 bytes</td>
</tr>
</tbody>
</table>
<p>These results are amazing! The smallest file is the file obtained by minifying jQuery using the YUI Compressor and  then gzipping. I would have thought that using Packer would have yielded the smallest file. In fact, it appears that Packer&#8217;s redundancy reduction algorithm is detrimental to gzip compression.</p>
<p>In addition to that, using Packer&#8217;s redundancy reduction algorithm adds a delay at the time the script gets executed (because the script needs to be unpacked and then eval&#8217;ed) On my laptop, this delay is about 200 msec. The conclusion is clear: for optimal performance, gzip your JavaScript code, and stay away from &#8220;advanced&#8221; JavaScript compression schemes that look attractive on paper, but end up degrading the performance of your site.</p>
<p>If your web hosting company does not offer HTTP compression, but gives you access to PHP (that&#8217;s the case of Yahoo! Web Hosting), I wrote a <a href="../../../../../blogfiles/gz.phps" target="_blank">simple PHP script</a> that will compress files and set the cache control headers so that the requested files actually get cached by the browser. I used this script with great success for a web site I worked on recently: <a href="http://www.okomis.com/" target="_blank">http://www.okomis.com/</a></p>
<p>Note: yahoo-dom-event.js, minified with the YUI Compressor and gzipped only weighs 9,476 bytes. Not bad!</p>
<p><strong>Update: </strong> Read this <a href="http://ejohn.org/blog/library-loading-speed/" target="_blank">article</a> by John Resig on JavaScript library Loading Speed.</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="../../index.html" rel="category tag">Web Development</a> on <a href="../../../../2007/08/13/index.html" title="3:11 pm" rel="bookmark"><time class="entry-date" datetime="2007-08-21T15:11:26+00:00">August 21, 2007</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../../../author/admin/index.html" title="View all posts by Julien Lecomte" rel="author">Julien Lecomte</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

	<article id="post-12" class="post-12 post type-post status-publish format-standard hentry category-web-development">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="../../../../2007/08/12/index.html" rel="bookmark">YUI Compressor Version 1.1 Now Available</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<p>The release of the <a href="../../../../2007/08/13/introducing-the-yui-compressor/index.html" target="_blank">YUI Compressor</a> last week has generated a lot of buzz and excitement throughout the web development community. Actually, after receiving so much great feedback, I felt compelled to issue a minor update as soon as possible to fix the most important items that were brought to my attention (see the <a href="http://www.julienlecomte.net/blogfiles/yuicompressor/CHANGELOG" target="_blank">CHANGELOG</a> file for a full list of changes) And please, keep the feedback coming!</p>
<p style="margin:30px 0;text-align:center;"><a href="http://www.julienlecomte.net/yuicompressor/" target="_blank" style="padding:8px;border:1px solid #bbb;font-weight:bold;text-decoration:underline;">Download version 1.1 of the YUI Compressor</a></p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="../../index.html" rel="category tag">Web Development</a> on <a href="../../../../2007/08/12/index.html" title="8:01 am" rel="bookmark"><time class="entry-date" datetime="2007-08-20T08:01:10+00:00">August 20, 2007</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../../../author/admin/index.html" title="View all posts by Julien Lecomte" rel="author">Julien Lecomte</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

	<article id="post-11" class="post-11 post type-post status-publish format-standard hentry category-web-development">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="../../../../index.html?p=11" rel="bookmark">Introducing the YUI Compressor</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<h4>Is there a need for a new JavaScript minifier?</h4>
<p><img src="../../../../../blogfiles/images/yuicompressor.png" style="width:100px;height:90px;border:none;float:left;margin-right:10px;" alt="Yahoo's YUI Compressor"></p>
<p>According to <a href="http://developer.yahoo.com/performance/" target="_blank">Yahoo!&#8217;s Exceptional Performance Team</a>, 40% to 60% of Yahoo!â€™s users have an empty cache experience and about 20% of all page views are done with an empty cache (see this <a href="http://yuiblog.com/blog/2007/01/04/performance-research-part-2/" target="_blank">article</a> for more information on browser cache usage) This fact outlines the importance of keeping web pages as lightweight as possible. Improving the engineering design of a page or a web application usually yields the biggest savings. After that come many different techniques such as minification of the code, <a href="http://en.wikipedia.org/wiki/Http_compression" target="_blank">HTTP compression</a>, etc. In terms of code minification, the most widely used tools to minify JavaScript code are Douglas Crockford&#8217;s <a href="http://crockford.com/javascript/jsmin" target="_blank">JSMin</a> and <a href="http://dojotoolkit.org/docs/shrinksafe" target="_blank">the Dojo compressor.</a> Both tools however have pitfalls. JSMin, for example, does not yield optimal savings (due to its simple algorithm, it must leave many line feed characters in the code in order not to introduce any new bugs) The Dojo compressor, on the other hand, does a better job at compacting code (it obfuscates local variables) but is unsafe and potentially introduces bugs if you are unaware of its limitations.</p>
<p><br style="clear:both;line-height:0;"/></p>
<h4>What is the YUI Compressor?</h4>
<p>The YUI Compressor is a new JavaScript minifier. Its level of compaction is higher than the Dojo compressor, and it is as safe as JSMin. Tests on the <a href="http://developer.yahoo.com/yui/" target="_blank">YUI library</a> have shown savings of about 18% compared to JSMin and 10% compared to the Dojo compressor (these respectively become 10% and 5% after HTTP compression)</p>
<h4>How does it work?</h4>
<p>The YUI Compressor is written in <a href="http://java.sun.com/" target="_blank">Java</a> (requires Java >= 1.4) and relies on <a href="http://www.mozilla.org/rhino/" target="_blank">Rhino</a> to tokenize the source JavaScript file. It starts by analyzing the source JavaScript file to understand how it is structured. It then prints out the token stream, replacing all local symbols by a 1 (or 2, or 3) letter symbol wherever such a substitution is appropriate (in the face of <a href="http://www.jslint.com/lint.html" target="_blank">evil features</a> such as <code>eval</code> or <code>with</code>, the YUI Compressor takes a defensive approach by not obfuscating any of the scopes containing the evil statement). The YUI Compressor is open-source, so don&#8217;t hesitate to look at the code to understand exactly how it works.</p>
<h4>Where can I get it?</h4>
<p>An archive containing both source and binary is available for <a href="http://www.julienlecomte.net/yuicompressor/" target="_blank">download</a> on this site.</p>
<h4>How do I run it?</h4>
<pre>
java -jar yuicompressor-1.0.jar
    [-h, --help] [--warn] [--nomunge]
    [--charset character-set] [-o outfile] infile
</pre>
<p>The following command line for example:</p>
<pre>java -jar yuicompressor-1.0.jar myfile.js</pre>
<p>will minify the file <code>myfile.js</code> and output the file <code>myfile-min.js</code>. For more information on how to use the YUI Compressor, please refer to the documentation included in the archive.</p>
<h4>Limitations</h4>
<p>Unlike JSMin, the YUI Compressor is slow and cannot be used for on-the-fly code minification (see <a href="http://code.google.com/p/minify/" target="_blank">minify</a> for a PHP implementation of JSMin by <a href="http://wonko.com/" target="_blank">Ryan Grove</a>, another Yahoo! engineer, that does on-the-fly JavaScript minification among other things)</p>
<h4>Has Yahoo!&#8217;s official position on obfuscation changed?</h4>
<p>Douglas Crockford wrote <a href="http://yuiblog.com/blog/2006/03/06/minification-v-obfuscation/" target="_blank">an interesting article</a> last year on minification vs. obfuscation. While that article still holds true, the YUI Compressor actually represents a 3rd way, in which code compaction does not carry the risk of introducing new bugs. The YUI Compressor is currently considered as a replacement for JSMin to compact the entire YUI library.</p>
<h4>Feedback appreciated</h4>
<p>The YUI Compressor is still a fairly new tool, so your feedback is well appreciated. Don&#8217;t hesitate to drop me a line if you find a bug, or think an important feature is missing. I will make updates available on this site, so watch for posts related to the YUI Compressor on this blog. This software belongs to the community, so it&#8217;s up to the community to make it better!</p>
<h4>Additional notes</h4>
<ul>
<li>Do not hesitate to use the <code>--warn</code> option. The YUI Compressor will warn you if it finds anything that seems abnormal with your code, or that might reduce the level of compression.</li>
<li>Keep as little of your code as possible in the global scope. This has 2 benefits:
<ol>
<li>You&#8217;ll get a better level of compression since the YUI Compressor does not obfuscate global symbols (which would make it unsafe)</li>
<li>You won&#8217;t pollute the global object (see this <a href="http://yuiblog.com/blog/2006/06/01/global-domination/" target="_blank">article</a>)</li>
</ol>
</li>
</ul>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="../../index.html" rel="category tag">Web Development</a> on <a href="../../../../index.html?p=11" title="12:27 pm" rel="bookmark"><time class="entry-date" datetime="2007-08-13T12:27:17+00:00">August 13, 2007</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../../../author/admin/index.html" title="View all posts by Julien Lecomte" rel="author">Julien Lecomte</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

	<article id="post-9" class="post-9 post type-post status-publish format-standard hentry category-web-development">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="../../../../2007/08/9/index.html" rel="bookmark">YUI-based Image Magnifier Widget</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<p><img src="../../../../../blogfiles/images/image-magnifier.thumbnail.jpg" style="float:left;margin-right:10px;width:250px;height:188px;"></p>
<p>I wrote a prototype YUI-based image magnifier widget that makes use of VML on Internet Explorer and the Canvas tag on all the other <a href="http://developer.yahoo.com/yui/articles/gbs/" target="_blank">A-grade browsers</a>. Attached is a screenshot.</p>
<p>To instantiate the widget, include the following source files in your web page (<strong>requires YUI >= 2.3</strong>)</p>
<p><br style="clear:both;"/></p>
<pre class="prettyprint">&#60;!-- CSS --&#62;
&#60;link rel="stylesheet" type="text/css" href="image-magnifier.css"&#62;

&#60;!-- Dependencies --&#62;
&#60;script src="yahoo-dom-event.js"&#62;&#60;/script&#62;
&#60;script src="dragdrop-min.js"&#62;&#60;/script&#62;

&#60;!-- Image cropper source file --&#62;
&#60;script src="image-magnifier-min.js"&#62;&#60;/script&#62;
</pre>
<p>Then, place an image on your page:</p>
<pre class="prettyprint">&#60;img src="myImage.jpg" id="myImageId"&#62;</pre>
<p>Finally, instantiate the widget:</p>
<pre class="prettyprint">
&#60;script&#62;
    new YAHOO.widget.ImageMagnifier("myImageId", "magnified.jpg");
&#60;/script&#62;
</pre>
<p>Although this prototype is not extremely polished, it should work fairly well right out of the box. Here is a <a href="../../../../../blogfiles/image-magnifier/index.html" target="_blank">live demo of the image magnifier widget</a> (drag the lens around). You can also download an <a href="../../../../../blogfiles/image-magnifier/image-magnifier.zip">archive</a> containing all the necessary source code.</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="../../index.html" rel="category tag">Web Development</a> on <a href="../../../../2007/08/9/index.html" title="10:59 am" rel="bookmark"><time class="entry-date" datetime="2007-08-07T10:59:30+00:00">August 7, 2007</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../../../author/admin/index.html" title="View all posts by Julien Lecomte" rel="author">Julien Lecomte</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

	<article id="post-8" class="post-8 post type-post status-publish format-standard hentry category-web-development">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="../../../../2007/07/8/index.html" rel="bookmark">Introducing iSearch, A Search Page Optimized For The iPhone</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<p><img src="../../../../../blogfiles/images/isearch-thumbnail.png" style="float:left;margin-right:10px;width:173px;height:233px;border:1px solid #aaa;padding:0;"></p>
<p>I hacked a search page optimized for the iPhone. It uses the <a href="http://developer.yahoo.com/search/" target="_blank">Yahoo! Search API</a> and bits of <a href="http://www.joehewitt.com/iui/" target="_blank">Joe Hewitt&#8217;s iUI library</a>. The address is:</p>
<p><a href="../../../../../isearch/index.html" target="_blank">http://www.julienlecomte.net/isearch/</a></p>
<p>Developing a web application for the iPhone is actually easier than traditional web development because of the fact that you are designing for a specific browser (Safari) running on a specific device with a known resolution (320 x 480)</p>
<p>I hope you&#8217;ll find this page useful. Comments and constructive criticism are welcome as always!</p>
<p><br style="clear:both;"/></p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="../../index.html" rel="category tag">Web Development</a> on <a href="../../../../2007/07/8/index.html" title="10:45 pm" rel="bookmark"><time class="entry-date" datetime="2007-07-28T22:45:11+00:00">July 28, 2007</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../../../author/admin/index.html" title="View all posts by Julien Lecomte" rel="author">Julien Lecomte</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->

	<article id="post-7" class="post-7 post type-post status-publish format-standard hentry category-web-development">
				<header class="entry-header">
			
						<h1 class="entry-title">
				<a href="../../../../2007/07/7/index.html" rel="bookmark">Exposing Extension Functionality to Web-Page Javascript</a>
			</h1>
								</header><!-- .entry-header -->

				<div class="entry-content">
			<p><img src="../../../../../blogfiles/images/firefox.png" style="float:right;width:60px;height:60px;border:none;padding:0;"></p>
<p style="padding-right:70px;">In this article, I describe how to implement a scriptable <a href="http://www.mozilla.org/projects/xpcom/book/cxc/" target="_blank">XPCOM Component</a>. This type of component exposes some extra functionality to untrusted web-page JavaScript running inside a Gecko-based browser such as Firefox. The implementation itself will be done in JavaScript.</p>
<p><br style="clear:both;"/></p>
<h4>Before we start</h4>
<p>First of all, you will need to download a recent version of the Mozilla source code. The Mozilla source code can be obtained either by downloading a source archive, or by using a CVS (source control) client. For our project, downloading a source archive is recommended, but if you wish to go down the CVS road, you should read this <a href="http://developer.mozilla.org/en/docs/Mozilla_Source_Code_Via_CVS" target="_blank">MDC article</a> first. In my case, I simply downloaded a <a href="http://mozilla.osuosl.org/pub/mozilla.org/firefox/releases/2.0.0.5/source/firefox-2.0.0.5-source.tar.bz2" target="_blank">tarball</a> of the Firefox 2.0.0.5 source code. Untar it using</p>
<pre>tar xjfv &#60;source-file.tar.bz2&#62;</pre>
<p>XPCOM uses its own variant of the CORBA OMG Interface Definition Language (IDL) called XPIDL. You will need a special compiler to process your XPIDL files. You can build the compiler yourself (the source for the compiler is under mozilla/xpcom/typelib/xpidl). If you&#8217;re on Windows (XP or Vista), you can simply download a statically linked Windows binary <a href="http://developer.mozilla.org/en/docs/User:Andywang:xpidl" target="_blank">here</a>.</p>
<h4>Define the component interface</h4>
<p>Let&#8217;s define the interface of our component. I will not delve into details about the actual XPIDL syntax. You can find more information on this <a href="http://developer.mozilla.org/en/docs/XPIDL:Syntax" target="_blank">here</a>. This interface resides in a file named <a href="../../../../../blogfiles/simple-xpcom/nsISimple.idl" target="_blank">nsSimple.idl</a>. The GUID was generated using <a href="http://search.yahoo.com/search?p=GUIDGen.exe" target="_blank">Microsoft&#8217;s GUIDGen.exe</a>.</p>
<pre class="prettyprint">
#include "nsISupports.idl"

[scriptable, uuid(B2A56E5E-CF18-4a8e-8EE9-CE228098516A)]
interface nsISimple : nsISupports {

    // Version string. Readonly!
    readonly attribute string version;

    // Dummy test function.
    string doSomething( in string value );
};
</pre>
<h4>Compile the interface file</h4>
<p>This file must be compiled using the XPIDL compiler using the following command line. This should generate a file name nsISimple.xpt.</p>
<pre style="overflow:auto;overflow-y:hidden;">
xpidl -m typelib -w -v -I &#60;path-to-mozilla-source&#62;/mozilla/xpcom/base -o nsISimple nsISimple.idl
</pre>
<h4>Interface implementation</h4>
<p>Once you have successfuly created an interface file that publicly defines the component&#8217;s methods and attributes, the next step is to implement those methods and attributes in a separate source file named <a href="../../../../../blogfiles/simple-xpcom/nsSimple.js" target="_blank">nsSimple.js</a>. The nsSimple object implements the nsISimple interface of course, but also the nsISupports interface (because nsISimple inherits from it) and the nsIClassInfo interface (this is needed because we are writing a scriptable component).</p>
<h4>Component registration and instantiation</h4>
<p>The second half of the file <a href="../../../../../blogfiles/simple-xpcom/nsSimple.js" target="_blank">nsSimple.js</a> contains the code necessary for the component instantiation and automatic registration. This code is fairly generic and does not change much from one component to another.</p>
<h4>Install the component and test it</h4>
<p>Copy the two files nsISimple.xpt and nsSimple.js to</p>
<pre>&#60;path-to-your-firefox-install&#62;/components/</pre>
<p>and restart Firefox. Create a simple HTML file as follows:</p>
<pre class="prettyprint">
&#60;html&#62;
  &#60;head&#62;
    &#60;title&#62;XPCOM test page&#60;/title&#62;
  &#60;/head&#62;
  &#60;body&#62;
    &#60;script&#62;

if (window.simpleObj) {
    alert(simpleObj.version);
    alert(simpleObj.doSomething("foo"));
}
    &#60;/script&#62;
  &#60;/body&#62;
&#60;/html&#62;
</pre>
<p>and open it up in Firefox. You should see a couple of alerts.</p>
<h4>Downloads</h4>
<p>I put together a complete <a href="../../../../../blogfiles/simple-xpcom/nsSimple.zip" target="_blank">archive</a> that contains all the necessary files.</p>
					</div><!-- .entry-content -->
		
		<footer class="entry-meta">
			This entry was posted in <a href="../../index.html" rel="category tag">Web Development</a> on <a href="../../../../2007/07/7/index.html" title="9:56 am" rel="bookmark"><time class="entry-date" datetime="2007-07-26T09:56:02+00:00">July 26, 2007</time></a><span class="by-author"> by <span class="author vcard"><a class="url fn n" href="../../../../author/admin/index.html" title="View all posts by Julien Lecomte" rel="author">Julien Lecomte</a></span></span>.								</footer><!-- .entry-meta -->
	</article><!-- #post -->
		<nav id="nav-below" class="navigation" role="navigation">
			<h3 class="assistive-text">Post navigation</h3>
			<div class="nav-previous"><a href="../4/index.html" ><span class="meta-nav">&larr;</span> Older posts</a></div>
			<div class="nav-next"><a href="../2/index.html" >Newer posts <span class="meta-nav">&rarr;</span></a></div>
		</nav><!-- #nav-below .navigation -->
	
		
		</div><!-- #content -->
	</section><!-- #primary -->


		<script type="text/javascript">
		window.onload = function(){prettyPrint();};
	</script>
	</div><!-- #main .wrapper -->
	<footer id="colophon" role="contentinfo">
		<div class="site-info">
						<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

<script type="text/javascript">
// <![CDATA[
// ]]>
</script>
<script type='text/javascript' src='../../../../wp-content/themes/twentytwelve/js/navigation.js'></script>
</body>
</html>
